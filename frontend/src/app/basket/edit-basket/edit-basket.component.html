<p>
  Pour valider votre commande, veuillez remplir le formulaire suivant.
</p>

<div class="border rounded bg-light p-5">
  <form [formGroup]="form" (ngSubmit)="save()">
    <div class="row">
      <div class="col-sm">
        <h2>Informations personnelles</h2>
        <div formGroupName="customer">
          <div class="form-group">
            <label for="name">Votre nom</label>
            <input formControlName="name" id="name" class="form-control" />
            <val-errors controlName="name" label="Le nom"></val-errors>
          </div>
          <div class="form-group">
            <label for="email">Votre adresse courriel</label>
            <input type="email" formControlName="email" id="email" class="form-control" />
            <val-errors controlName="email" label="L'adresse courriel"></val-errors>
          </div>
          <div class="form-group">
            <label for="address">Votre adresse postale</label>
            <textarea formControlName="address" id="address" class="form-control"></textarea>
            <val-errors controlName="address" label="L'adresse postale"></val-errors>
          </div>
          <div class="form-group">
            <label for="type">Comment vous décririez-vous?</label>
            <select formControlName="type" id="type" class="form-control custom-select">
              <option [ngValue]="null"></option>
              <option *ngFor="let customerType of customerTypes" [value]="customerType">{{ customerType | customerTypeEnum }}</option>
            </select>
            <val-errors controlName="type" label="La catégorie"></val-errors>
          </div>
        </div>
        <div class="form-group">
          <label for="rationale">Description de votre commande</label>
          <textarea formControlName="rationale" id="rationale" class="form-control" style="height: 8rem;"></textarea>
          <small class="text-muted form-text">
            Merci d'indiquer ici toutes les informations qui peuvent nous aider à gérer rapidement votre commande&nbsp;:
            <ul>
              <li>dans quel but faites-vous cette commande&nbsp;?</li>
              <li>de quelles quantités avez-vous besoin&nbsp;?</li>
              <li>etc.</li>
            </ul>
          </small>
        </div>
      </div>
      <div class="col-sm" formArrayName="items">
        <h2>Accessions commandées</h2>

        <table class="table table-sm">
          <thead class="thead-light">
            <tr>
              <th>Accession</th>
              <th *ngIf="quantityDisplayed">Quantity</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let itemGroup of items.controls; index as index" class="accession">
              <td><rb-accession [accession]="itemGroup.get('accession').value"></rb-accession></td>
              <td *ngIf="quantityDisplayed">{{ itemGroup.get('quantity').value | number }}</td>
              <td class="text-right">
                <button
                  [disabled]="items.controls.length === 1"
                  type="button"
                  class="btn btn-outline-danger py-0 delete-btn"
                  (click)="deleteItemAt(index)"
                >
                  <fa-icon [icon]="deleteIcon"></fa-icon>
                  <span class="sr-only"
                    >Supprimer l'accession <rb-accession [accession]="itemGroup.get('accession').value"></rb-accession> de la commande</span
                  >
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="text-center mt-4">
      <button class="btn btn-primary" id="save">
        <fa-icon [icon]="saveIcon" class="mr-1"></fa-icon>
        Finaliser ma commande
      </button>
    </div>
  </form>
</div>
